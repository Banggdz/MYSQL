
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.ResultSet;
import java.sql.PreparedStatement; 
import java.util.Scanner;
public class test {
    private static String url = "jdbc:mysql://localhost:3306/northwind?autoReconnect=true&useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true";
    private static String username = "root";
    private static String password = "x";

    public static Connection getConnection() throws ClassNotFoundException, SQLException {
        Class.forName("com.mysql.cj.jdbc.Driver");
        return (Connection)DriverManager.getConnection(url,username,password);
    }

    public static void main(String[] args) throws ClassNotFoundException, SQLException {
        Connection conn = getConnection();
        if (conn == null) {
            System.out.println("üîå Failed");
        }
        else{
            System.out.println("Successfully");
//SELECT: executeQuery():resultSet
//DELETE,DROP,ALTER..: executeUpdate()

            //truy v·∫•n update d·ªØ li·ªáu
            Statement st=conn.createStatement();
            //Truy v·∫•n d·ªØ li·ªáu
            ResultSet rs=st.executeQuery("SELECT * FROM Customers WHERE CustomerID>=40");
            while(rs.next()){
System.out.println(rs.getInt(1)+" "+rs.getString(2)
+" "+rs.getString(3)+" "+rs.getString(4)+" "+rs.getString("city")+" "+rs.getString(7)                );
            }
        //Truy v·∫•n: execute update
    int row=st.executeUpdate("INSERT INTO Customers VALUE(1999,'Nguyen van nam','nam','hai duong','hai duong',2008,'vn')");
            System.out.println(row);    
       
PreparedStatement stmt=conn.prepareStatement("SELECT * FROM Customers WHERE CUStomerID>=? AND Country=?");     
stmt.setInt(1,50);
stmt.setString(2,"USA");
ResultSet rs=stmt.executeQuery();
while(rs.next()){
System.out.println(rs.getInt(1)+" "+rs.getString(2)
+" "+rs.getString(3)+" "+rs.getString(4)+" "+rs.getString("city")+" "+rs.getString(7)                );
}
PreparedStatement stmt = conn.prepareStatement("INSERT INTO Customers VALUES (?, ?, ?, ?, ?, ?, ?)"); 
System.out.print("Nh·∫≠p s·ªë l∆∞·ª£ng kh√°ch h√†ng: "); 
Scanner sc= new Scanner(System.in);
int numberOfCustomers = Integer.parseInt(sc.nextLine()); 
for (int i = 0; i < numberOfCustomers; i++) { 
    System.out.println("Nh·∫≠p th√¥ng tin kh√°ch h√†ng th·ª© " + (i + 1) + ":"); 
    int id = Integer.parseInt(sc.nextLine()); 
    String name = sc.nextLine(); 
    String contactName = sc.nextLine(); 
    String address = sc.nextLine(); 
    String postalCode = sc.nextLine(); 
    String city = sc.nextLine(); 
    String country = sc.nextLine(); 
    stmt.setInt(1, id); 
    stmt.setString(2, name); 
    stmt.setString(3, contactName); 
    stmt.setString(4, address); 
    stmt.setString(5, city); 
    stmt.setString(6, postalCode); 
    stmt.setString(7, country); 
    stmt.executeUpdate(); }
        }
    }
}

------------


import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.SQLException;
import java.sql.Statement;
import java.sql.ResultSet;
import java.sql.PreparedStatement; 
import java.util.Scanner;
public class test {
    private static String url = "jdbc:mysql://localhost:3306/northwind?autoReconnect=true&useSSL=false&serverTimezone=UTC&allowPublicKeyRetrieval=true";
    private static String username = "root";
    private static String password = "x";

    public static Connection getConnection() throws ClassNotFoundException, SQLException {
        Class.forName("com.mysql.cj.jdbc.Driver");
        return (Connection)DriverManager.getConnection(url,username,password);
    }

    public static void main(String[] args) throws ClassNotFoundException, SQLException {
        Connection conn = getConnection();
        conn.setAutoCommit(false);
        if (conn == null) {
            System.out.println("üîå Failed");
        }
        else{
try{  
PreparedStatement stmt = conn.prepareStatement("INSERT INTO Customers VALUES (?, ?, ?, ?, ?, ?, ?)"); 

Scanner sc= new Scanner(System.in);
int numberOfCustomers = Integer.parseInt(sc.nextLine()); 
for (int i = 0; i < numberOfCustomers; i++) { 
    int id = Integer.parseInt(sc.nextLine()); 
    String name = sc.nextLine(); 
    String contactName = sc.nextLine(); 
    String address = sc.nextLine(); 
    String postalCode = sc.nextLine(); 
    String city = sc.nextLine(); 
    String country = sc.nextLine(); 
    stmt.setInt(1, id); 
    stmt.setString(2, name); 
    stmt.setString(3, contactName); 
    stmt.setString(4, address); 
    stmt.setString(5, city); 
    stmt.setString(6, postalCode); 
    stmt.setString(7, country); 
    stmt.executeUpdate(); }
conn.commit();
        }

catch(Exception e){
    System.out.println(e);
    conn.rollback();
          }
       }
    
    }
}
/*
2
2008
nguyen van t
thanh 
hai phong 
hai phong 
2490
VN
2009
nguyen van b
bb
hai phong 
hai phong 
249
VN

2
2010
tran van a
anh
ha noi
ha noi
1234
VN
2010
le thi b
bich
da nang
da nang
5678
VN

*/
